<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Invoice Generator – Free PDF Invoice Tool | ToolNest</title>

<meta name="description" content="Create professional GST invoice online. Add logo, items, discount, tax and download invoice PDF instantly.">
<meta name="viewport" content="width=device-width, initial-scale=1">

<link rel="stylesheet" href="../style.css">
<link rel="icon" href="../favicon.png">

<!-- PDF Libraries -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

</head>

<body class="tool-invoice">

<div id="header"></div>

<section class="mini-hero">
<div class="hero-top">
<a href="../index.html" class="back-home">⬅ Back to Home</a>
</div>
<h1>Professional Invoice Generator</h1>
<p>Create, Edit & Download GST Invoice PDF</p>
</section>

<div class="container">

<div class="tool-box invoice-form">

<h3>Company Details</h3>
<input type="text" id="companyName" placeholder="Company Name">
<input type="text" id="companyGST" placeholder="GST Number (Optional)">
<input type="file" id="logoUpload">

<h3>Invoice Details</h3>
<select id="invoiceMode">
<option value="auto">Auto Invoice Number</option>
<option value="manual">Manual Invoice Number</option>
</select>
<input type="text" id="invoiceNumber" placeholder="Invoice Number">

<h3>Customer Details</h3>
<input type="text" id="customerName" placeholder="Customer Name">

<h3>Items</h3>
<table id="itemTable">
<thead>
<tr>
<th>Item</th>
<th>Qty</th>
<th>Price</th>
<th>Total</th>
<th>Remove</th>
</tr>
</thead>
<tbody></tbody>
</table>

<button onclick="addItem()">Add Item</button>

<h3>Extra</h3>
<input type="number" id="discount" placeholder="Discount % (Optional)">
<input type="number" id="tax" placeholder="GST % (Optional)">

<br><br>

<button onclick="generateInvoice()">Generate Invoice</button>
<button onclick="downloadPDF()">Download PDF</button>
<button onclick="editInvoice()">Edit Invoice</button>

</div>

<div class="invoice-box" id="invoicePreview" style="display:none;"></div>

</div>

<script>

let logoBase64 = "";

document.getElementById("logoUpload").addEventListener("change", function(e){
const reader = new FileReader();
reader.onload = function(){
logoBase64 = reader.result;
};
reader.readAsDataURL(e.target.files[0]);
});

function addItem(){
const row = document.createElement("tr");
row.innerHTML = `
<td><input type="text" class="itemName"></td>
<td><input type="number" class="itemQty" value="1"></td>
<td><input type="number" class="itemPrice" value="0"></td>
<td class="itemTotal">0</td>
<td><button onclick="this.closest('tr').remove()">X</button></td>
`;
document.querySelector("#itemTable tbody").appendChild(row);
}

function generateInvoice(){

const company = companyName.value;
const gst = companyGST.value;
const customer = customerName.value;
let invoiceNo = invoiceNumber.value;

if(invoiceMode.value === "auto"){
invoiceNo = "INV-" + Date.now();
invoiceNumber.value = invoiceNo;
}

let subtotal = 0;
let rows = document.querySelectorAll("#itemTable tbody tr");

let itemHTML = "";

rows.forEach(row=>{
const name = row.querySelector(".itemName").value;
const qty = parseFloat(row.querySelector(".itemQty").value);
const price = parseFloat(row.querySelector(".itemPrice").value);
const total = qty * price;
subtotal += total;
row.querySelector(".itemTotal").innerText = total.toFixed(2);

itemHTML += `<tr>
<td>${name}</td>
<td>${qty}</td>
<td>${price}</td>
<td>${total.toFixed(2)}</td>
</tr>`;
});

let discountVal = discount.value ? subtotal * (discount.value/100) : 0;
let taxVal = tax.value ? (subtotal - discountVal) * (tax.value/100) : 0;
let grandTotal = subtotal - discountVal + taxVal;

invoicePreview.style.display = "block";

invoicePreview.innerHTML = `
<div id="pdfArea">
${logoBase64 ? `<img src="${logoBase64}" width="120"><br>` : ""}
<h2>${company}</h2>
${gst ? `<p>GST: ${gst}</p>` : ""}
<hr>
<p><strong>Invoice No:</strong> ${invoiceNo}</p>
<p><strong>Customer:</strong> ${customer}</p>

<table border="1" width="100%" cellpadding="8" cellspacing="0">
<tr>
<th>Item</th><th>Qty</th><th>Price</th><th>Total</th>
</tr>
${itemHTML}
</table>

<br>
<p>Subtotal: ₹${subtotal.toFixed(2)}</p>
${discountVal ? `<p>Discount: -₹${discountVal.toFixed(2)}</p>` : ""}
${taxVal ? `<p>GST: ₹${taxVal.toFixed(2)}</p>` : ""}
<h3>Grand Total: ₹${grandTotal.toFixed(2)}</h3>

</div>
`;

}

async function downloadPDF(){

const { jsPDF } = window.jspdf;
const element = document.getElementById("pdfArea");

await html2canvas(element,{scale:2}).then(canvas=>{
const imgData = canvas.toDataURL("image/png");
const pdf = new jsPDF("p","mm","a4");
const width = pdf.internal.pageSize.getWidth();
const height = (canvas.height * width) / canvas.width;
pdf.addImage(imgData,"PNG",0,0,width,height);
pdf.save("invoice.pdf");
});

}

function editInvoice(){
invoicePreview.style.display = "none";
window.scrollTo({top:0,behavior:"smooth"});
}

</script>

</body>
</html>
